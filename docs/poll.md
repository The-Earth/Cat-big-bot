# Poll

投票由 [`admin`](admin.md) 用户创建并启动，[`voter`](voter.md) 用户可以通过按钮投票。可以设定单多选、投票期间匿名与否、投票后匿名与否以及投票期间是否显示各选项票数。

## /init_poll
限 `admin` 用户于群组中使用。格式：
```
/init_poll -n 标题 -o !选项1 !选项2 ... -t 时长 [-ao] [-ac] [-c] [-m]
```
* `-n` 后接标题文字，可以含空格，不可含 `-` 
* `-o` 后接选项，每个选项以 `!` 开头，选项文字可以含空格，不可含 `!` 和 `-`，选项个数不限
* `-t` 后接投票时长，格式灵活，大致来说 `2 hours 30 mins`、`1w 4d` 之类的都是可以接受的。然而所使用的解析库没有给出明确接受的范围，推测一般的简洁时间表达均可。若投票开始后显示的结束时间不正常，则说明识别失败。详见[这份文档](https://dateparser.readthedocs.io/en/latest/#relative-dates)
* `-ao` 若添加此参数，则投票结束前会显示各个选项的投票者，否则不显示
* `-ac` 若添加此参数，则投票结束后会显示各个选项的投票者，否则不显示
* `-c` 若添加此参数，则投票结束前会显示各个选项的投票人数，否则不显示。投票结束后一定会显示各选项的人数（废话，不然投票就没意义了）
* `-m` 若添加此参数，则投票允许多选

机器人会回复一条消息，内含投票设置以及开启该投票的按钮。使用按钮开启投票以后，会自动设置结束时间。

## 投票开始按钮

限 `admin` 用户于群组中点按，按下后将启动投票。

## 选项按钮

限 `voter` 用户于群组中点按，按下后会有提示告知已经收到您的票，只要出现该提示，就不需要再次按按钮，以免计票异常。分不同情况，按下后会有不同的效果：

* 多选投票
    * 按下已投的选项时，撤销该选项的票
    * 按下未投的选项时，选中该选项
* 单选投票
    * 已投其他选项时，撤销先前的选项，选中新点按的选项
    * 未投其他选项时，选中该选项
    * 已投当前被点按的选项时，撤销该选项的票

## 投票结束按钮

限 `admin` 用户于群组中点按。按下后提前结束投票，显示投票结果。

## 自动结束投票

机器人会在设置的投票时间结束后自动关闭投票，并发出一条附有投票链接的消息以作提醒。
